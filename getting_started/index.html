


<!doctype html>
<html class="no-js" lang="en">
  
<head><!-- begin head.html -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
    Getting Started | Scylla Docs
    </title>
    <meta name="description" content="Scylla is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />

    <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://docs.scylladb.com/">

    <link rel="author" href="mailto:info@scylladb.com">
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/doc/main.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script src="../_static/js/vendor/modernizr.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T8P2JP');</script>
    <!-- End Google Tag Manager -->

    <!-- Marketo -->
    <script type="text/javascript"> (function() { var didInit = false; function initMunchkin() { if(didInit === false) { didInit = true; Munchkin.init('791-QBF-350'); } } var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//munchkin.marketo.net/munchkin.js'; s.onreadystatechange = function() { if (this.readyState == 'complete' || this.readyState == 'loaded') { initMunchkin(); } }; s.onload = initMunchkin; document.getElementsByTagName('head')[0].appendChild(s); })(); </script>
    <!-- End Marketo -->

<!-- end head.html -->
</head>

<body>
<header id="header" class="animated">
    <div class="topbar_continer contain-to-grid clearfix">
        <nav class="top-bar" id="top-bar" data-topbar role="navigation">
            <ul class="title-area">
                <li class="name">
                    <div class="logo">
                        <a href="https://docs.scylladb.com/"><img src="../_static/img/logo-scylla-docs.svg" alt="" width="151"></a>
                    </div>
                </li>
                <li class="toggle-topbar"><a href="#"><span class="icon-manu"></span></a></li>
            </ul>
            <section class="top-bar-section clearfix">
                <ul class="right">
                    
                    <li>
                        <a href="/">Scylla Python Driver</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">Scylla Cloud</a>
                    </li>
                    
                    <li>
                        <a href="https://university.scylladb.com/">Scylla University</a>
                    </li>
                    
                    <li>
                        <a href="https://www.scylladb.com/">ScyllaDB Home</a>
                    </li>
                    
                    <li class="search_continer show-for-medium-up">	
                        <ci-search></ci-search>	
                    </li>	
                </ul>
            </section>
        </nav>
    </div>
</header>
<section id="content">
    <div class="row">
	
	<div class="large-6 large-push-3 columns">
            

            <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>First, make sure you have the driver properly <a class="reference internal" href="../installation/"><span class="doc">installed</span></a>.</p>
<div class="section" id="connecting-to-cassandra">
<h2>Connecting to Cassandra<a class="headerlink" href="#connecting-to-cassandra" title="Permalink to this headline">¶</a></h2>
<p>Before we can start executing any queries against a Cassandra cluster we need to setup
an instance of <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster" title="cassandra.cluster.Cluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code></a>. As the name suggests, you will typically have one
instance of <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster" title="cassandra.cluster.Cluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code></a> for each Cassandra cluster you want to interact
with.</p>
<p>The simplest way to create a <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster" title="cassandra.cluster.Cluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code></a> is like this:
First, make sure you have the Cassandra driver properly <a class="reference internal" href="../installation/"><span class="doc">installed</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">()</span>
</pre></div>
</div>
<p>This will attempt to connection to a Cassandra instance on your
local machine (127.0.0.1).  You can also specify a list of IP
addresses for nodes in your cluster:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">([</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.0.2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The set of IP addresses we pass to the <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster" title="cassandra.cluster.Cluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code></a> is simply
an initial set of contact points.  After the driver connects to one
of these nodes it will <em>automatically discover</em> the rest of the
nodes in the cluster and connect to them, so you don’t need to list
every node in your cluster.</p>
<p>If you need to use a non-standard port, use SSL, or customize the driver’s
behavior in some other way, this is the place to do it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">([</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;192.168.0.2&#39;</span><span class="p">],</span> <span class="n">port</span><span class="o">=...</span><span class="p">,</span> <span class="n">ssl_context</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>Instantiating a <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster" title="cassandra.cluster.Cluster"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cluster</span></code></a> does not actually connect us to any nodes.
To establish connections and begin executing queries we need a
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session" title="cassandra.cluster.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, which is created by calling <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster.connect" title="cassandra.cluster.Cluster.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cluster.connect()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Cluster.connect" title="cassandra.cluster.Cluster.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connect()</span></code></a> method takes an optional <code class="docutils literal notranslate"><span class="pre">keyspace</span></code> argument
which sets the default keyspace for all queries made through that <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session" title="cassandra.cluster.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;mykeyspace&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can always change a Session’s keyspace using <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.set_keyspace" title="cassandra.cluster.Session.set_keyspace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_keyspace()</span></code></a> or
by executing a <code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">&lt;keyspace&gt;</span></code> query:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">set_keyspace</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="c1"># or you can do this instead</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;USE users&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Profiles are passed in by <code class="docutils literal notranslate"><span class="pre">execution_profiles</span></code> dict.</p>
<p>In this case we can construct the base <code class="docutils literal notranslate"><span class="pre">ExecutionProfile</span></code> passing all attributes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span><span class="p">,</span> <span class="n">ExecutionProfile</span><span class="p">,</span> <span class="n">EXEC_PROFILE_DEFAULT</span>
<span class="kn">from</span> <span class="nn">cassandra.policies</span> <span class="kn">import</span> <span class="n">WhiteListRoundRobinPolicy</span><span class="p">,</span> <span class="n">DowngradingConsistencyRetryPolicy</span>
<span class="kn">from</span> <span class="nn">cassandra.query</span> <span class="kn">import</span> <span class="n">tuple_factory</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">ExecutionProfile</span><span class="p">(</span>
    <span class="n">load_balancing_policy</span><span class="o">=</span><span class="n">WhiteListRoundRobinPolicy</span><span class="p">([</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">]),</span>
    <span class="n">retry_policy</span><span class="o">=</span><span class="n">DowngradingConsistencyRetryPolicy</span><span class="p">(),</span>
    <span class="n">consistency_level</span><span class="o">=</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">LOCAL_QUORUM</span><span class="p">,</span>
    <span class="n">serial_consistency_level</span><span class="o">=</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">LOCAL_SERIAL</span><span class="p">,</span>
    <span class="n">request_timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">row_factory</span><span class="o">=</span><span class="n">tuple_factory</span>
<span class="p">)</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="n">execution_profiles</span><span class="o">=</span><span class="p">{</span><span class="n">EXEC_PROFILE_DEFAULT</span><span class="p">:</span> <span class="n">profile</span><span class="p">})</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT release_version FROM system.local&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
</pre></div>
</div>
<p>Users are free to setup additional profiles to be used by name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">profile_long</span> <span class="o">=</span> <span class="n">ExecutionProfile</span><span class="p">(</span><span class="n">request_timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="n">execution_profiles</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;long&#39;</span><span class="p">:</span> <span class="n">profile_long</span><span class="p">})</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">statement</span><span class="p">,</span> <span class="n">execution_profile</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, parameters passed to <code class="docutils literal notranslate"><span class="pre">Session.execute</span></code> or attached to <code class="docutils literal notranslate"><span class="pre">Statement</span></code>s are still honored as before.</p>
</div>
<div class="section" id="executing-queries">
<h2>Executing Queries<a class="headerlink" href="#executing-queries" title="Permalink to this headline">¶</a></h2>
<p>Now that we have a <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session" title="cassandra.cluster.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> we can begin to execute queries. The simplest
way to execute a query is to use <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.execute" title="cassandra.cluster.Session.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT name, age, email FROM users&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">user_row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">user_row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">user_row</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">user_row</span><span class="o">.</span><span class="n">email</span>
</pre></div>
</div>
<p>This will transparently pick a Cassandra node to execute the query against
and handle any retries that are necessary if the operation fails.</p>
<p>By default, each row in the result set will be a
<a class="reference external" href="http://docs.python.org/2/library/collections.html#collections.namedtuple">namedtuple</a>.
Each row will have a matching attribute for each column defined in the schema,
such as <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">age</span></code>, and so on.  You can also treat them as normal tuples
by unpacking them or accessing fields by position.  The following three
examples are equivalent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT name, age, email FROM users&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">row</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">email</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT name, age, email FROM users&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">email</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT name, age, email FROM users&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>If you prefer another result format, such as a <code class="docutils literal notranslate"><span class="pre">dict</span></code> per row, you
can change the <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.row_factory" title="cassandra.cluster.Session.row_factory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_factory</span></code></a> attribute.</p>
<p>As mentioned in our <a class="reference external" href="https://docs.datastax.com/en/devapp/doc/devapp/driversBestPractices.html#driversBestPractices__usePreparedStatements">Drivers Best Practices Guide</a>,
it is highly recommended to use <a class="reference external" href="#prepared-statement">Prepared statements</a> for your
frequently run queries.</p>
</div>
<div class="section" id="prepared-statement">
<span id="id1"></span><h2>Prepared Statements<a class="headerlink" href="#prepared-statement" title="Permalink to this headline">¶</a></h2>
<p>Prepared statements are queries that are parsed by Cassandra and then saved
for later use.  When the driver uses a prepared statement, it only needs to
send the values of parameters to bind.  This lowers network traffic
and CPU utilization within Cassandra because Cassandra does not have to
re-parse the query each time.</p>
<p>To prepare a query, use <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.prepare" title="cassandra.cluster.Session.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.prepare()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">user_lookup_stmt</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE user_id=?&quot;</span><span class="p">)</span>

<span class="n">users</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">user_ids_to_query</span><span class="p">:</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">user_lookup_stmt</span><span class="p">,</span> <span class="p">[</span><span class="n">user_id</span><span class="p">])</span>
    <span class="n">users</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.prepare" title="cassandra.cluster.Session.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare()</span></code></a> returns a <a class="reference internal" href="../api/cassandra/query/#cassandra.query.PreparedStatement" title="cassandra.query.PreparedStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PreparedStatement</span></code></a> instance
which can be used in place of <a class="reference internal" href="../api/cassandra/query/#cassandra.query.SimpleStatement" title="cassandra.query.SimpleStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleStatement</span></code></a> instances or literal
string queries.  It is automatically prepared against all nodes, and the driver
handles re-preparing against new nodes and restarted nodes when necessary.</p>
<p>Note that the placeholders for prepared statements are <code class="docutils literal notranslate"><span class="pre">?</span></code> characters.  This
is different than for simple, non-prepared statements (although future versions
of the driver may use the same placeholders for both).</p>
<div class="section" id="passing-parameters-to-cql-queries">
<h3>Passing Parameters to CQL Queries<a class="headerlink" href="#passing-parameters-to-cql-queries" title="Permalink to this headline">¶</a></h3>
<p>Althought it is not recommended, you can also pass parameters to non-prepared
statements. The driver supports two forms of parameter place-holders: positional
and named.</p>
<p>Positional parameters are used with a <code class="docutils literal notranslate"><span class="pre">%s</span></code> placeholder.  For example,
when you execute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INSERT INTO users (name, credits, user_id)</span>
<span class="sd">    VALUES (%s, %s, %s)</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;John O&#39;Reilly&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
<span class="p">)</span>
</pre></div>
</div>
<p>It is translated to the following CQL query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">users</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">credits</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>
<span class="n">VALUES</span> <span class="p">(</span><span class="s1">&#39;John O&#39;&#39;Reilly&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">2644</span><span class="n">bada</span><span class="o">-</span><span class="mi">852</span><span class="n">c</span><span class="o">-</span><span class="mf">11e3</span><span class="o">-</span><span class="mi">89</span><span class="n">fb</span><span class="o">-</span><span class="n">e0b9a54a6d93</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that you should use <code class="docutils literal notranslate"><span class="pre">%s</span></code> for all types of arguments, not just strings.
For example, this would be <strong>wrong</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO USERS (name, age) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;bob&quot;</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>  <span class="c1"># wrong</span>
</pre></div>
</div>
<p>Instead, use <code class="docutils literal notranslate"><span class="pre">%s</span></code> for the age placeholder.</p>
<p>If you need to use a literal <code class="docutils literal notranslate"><span class="pre">%</span></code> character, use <code class="docutils literal notranslate"><span class="pre">%%</span></code>.</p>
<p><strong>Note</strong>: you must always use a sequence for the second argument, even if you are
only passing in a single variable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO foo (bar) VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="s2">&quot;blah&quot;</span><span class="p">)</span>  <span class="c1"># wrong</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO foo (bar) VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;blah&quot;</span><span class="p">))</span>  <span class="c1"># wrong</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO foo (bar) VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;blah&quot;</span><span class="p">,</span> <span class="p">))</span>  <span class="c1"># right</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO foo (bar) VALUES (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;blah&quot;</span><span class="p">])</span>  <span class="c1"># right</span>
</pre></div>
</div>
<p>Note that the second line is incorrect because in Python, single-element tuples
require a comma.</p>
<p>Named place-holders use the <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INSERT INTO users (name, credits, user_id, username)</span>
<span class="sd">    VALUES (%(name)s, %(credits)s, %(user_id)s, %(name)s)</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&quot;John O&#39;Reilly&quot;</span><span class="p">,</span> <span class="s1">&#39;credits&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">()}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that you can repeat placeholders with the same name, such as <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code>
in the above example.</p>
<p>Only data values should be supplied this way.  Other items, such as keyspaces,
table names, and column names should be set ahead of time (typically using
normal string formatting).</p>
</div>
<div class="section" id="type-conversions">
<span id="id2"></span><h3>Type Conversions<a class="headerlink" href="#type-conversions" title="Permalink to this headline">¶</a></h3>
<p>For non-prepared statements, Python types are cast to CQL literals in the
following way:</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Python Type</th>
<th class="head">CQL Literal Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">NULL</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bool</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">boolean</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">float</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">double</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">int</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">long</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">int</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">bigint</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">varint</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">smallint</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tinyint</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">counter</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">decimal.Decimal</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">decimal</span></code></td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">str</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">unicode</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">ascii</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">varchar</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">text</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">buffer</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">bytearray</span></code></div>
</div>
</td>
<td><code class="docutils literal notranslate"><span class="pre">blob</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">date</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">date</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">datetime</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">time</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">time</span></code></td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">list</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tuple</span></code></div>
<div class="line">generator</div>
</div>
</td>
<td><code class="docutils literal notranslate"><span class="pre">list</span></code></td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">set</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">frozenset</span></code></div>
</div>
</td>
<td><code class="docutils literal notranslate"><span class="pre">set</span></code></td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">dict</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code></div>
</div>
</td>
<td><code class="docutils literal notranslate"><span class="pre">map</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">uuid.UUID</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">timeuuid</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">uuid</span></code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="asynchronous-queries">
<h3>Asynchronous Queries<a class="headerlink" href="#asynchronous-queries" title="Permalink to this headline">¶</a></h3>
<p>The driver supports asynchronous query execution through
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.Session.execute_async" title="cassandra.cluster.Session.execute_async"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_async()</span></code></a>.  Instead of waiting for the query to
complete and returning rows directly, this method almost immediately
returns a <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture" title="cassandra.cluster.ResponseFuture"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResponseFuture</span></code></a> object.  There are two ways of
getting the final result from this object.</p>
<p>The first is by calling <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture.result" title="cassandra.cluster.ResponseFuture.result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">result()</span></code></a> on it. If
the query has not yet completed, this will block until it has and
then return the result or raise an Exception if an error occurred.
For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra</span> <span class="kn">import</span> <span class="n">ReadTimeout</span>

<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM users WHERE user_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_async</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="n">user_id</span><span class="p">])</span>

<span class="c1"># ... do some other work</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">age</span>
<span class="k">except</span> <span class="n">ReadTimeout</span><span class="p">:</span>
    <span class="n">log</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Query timed out:&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This works well for executing many queries concurrently:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># build a list of futures</span>
<span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM users WHERE user_id=</span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="k">for</span> <span class="n">user_id</span> <span class="ow">in</span> <span class="n">ids_to_fetch</span><span class="p">:</span>
    <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">execute_async</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="n">user_id</span><span class="p">])</span>

<span class="c1"># wait for them to complete and use the results</span>
<span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">:</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="nb">print</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>Alternatively, instead of calling <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture.result" title="cassandra.cluster.ResponseFuture.result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">result()</span></code></a>,
you can attach callback and errback functions through the
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture.add_callback" title="cassandra.cluster.ResponseFuture.add_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_callback()</span></code></a>,
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture.add_errback" title="cassandra.cluster.ResponseFuture.add_errback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_errback()</span></code></a>, and
<a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ResponseFuture.add_callbacks" title="cassandra.cluster.ResponseFuture.add_callbacks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_callbacks()</span></code></a>, methods.  If you have used
Twisted Python before, this is designed to be a lightweight version of
that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">handle_success</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">process_user</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to process user </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="c1"># don&#39;t re-raise errors in the callback</span>

<span class="k">def</span> <span class="nf">handle_error</span><span class="p">(</span><span class="n">exception</span><span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to fetch user info: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span>


<span class="n">future</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute_async</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">future</span><span class="o">.</span><span class="n">add_callbacks</span><span class="p">(</span><span class="n">handle_success</span><span class="p">,</span> <span class="n">handle_error</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>There are a few important things to remember when working with callbacks:</dt>
<dd><ul class="first last simple">
<li><strong>Exceptions that are raised inside the callback functions will be logged and then ignored.</strong></li>
<li>Your callback will be run on the event loop thread, so any long-running
operations will prevent other requests from being handled</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="setting-a-consistency-level">
<h2>Setting a Consistency Level<a class="headerlink" href="#setting-a-consistency-level" title="Permalink to this headline">¶</a></h2>
<p>The consistency level used for a query determines how many of the
replicas of the data you are interacting with need to respond for
the query to be considered a success.</p>
<p>By default, <a class="reference internal" href="../api/cassandra/#cassandra.ConsistencyLevel.LOCAL_ONE" title="cassandra.ConsistencyLevel.LOCAL_ONE"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConsistencyLevel.LOCAL_ONE</span></code></a> will be used for all queries.
You can specify a different default by setting the <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.ExecutionProfile.consistency_level" title="cassandra.cluster.ExecutionProfile.consistency_level"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ExecutionProfile.consistency_level</span></code></a>
for the execution profile with key <a class="reference internal" href="../api/cassandra/cluster/#cassandra.cluster.EXEC_PROFILE_DEFAULT" title="cassandra.cluster.EXEC_PROFILE_DEFAULT"><code class="xref py py-data docutils literal notranslate"><span class="pre">EXEC_PROFILE_DEFAULT</span></code></a>.
To specify a different consistency level per request, wrap queries
in a <a class="reference internal" href="../api/cassandra/query/#cassandra.query.SimpleStatement" title="cassandra.query.SimpleStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleStatement</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra</span> <span class="kn">import</span> <span class="n">ConsistencyLevel</span>
<span class="kn">from</span> <span class="nn">cassandra.query</span> <span class="kn">import</span> <span class="n">SimpleStatement</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">SimpleStatement</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO users (name, age) VALUES (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="n">consistency_level</span><span class="o">=</span><span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">QUORUM</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="setting-a-consistency-level-with-prepared-statements">
<h3>Setting a Consistency Level with Prepared Statements<a class="headerlink" href="#setting-a-consistency-level-with-prepared-statements" title="Permalink to this headline">¶</a></h3>
<p>To specify a consistency level for prepared statements, you have two options.</p>
<p>The first is to set a default consistency level for every execution of the
prepared statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra</span> <span class="kn">import</span> <span class="n">ConsistencyLevel</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;mykeyspace&quot;</span><span class="p">)</span>
<span class="n">user_lookup_stmt</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE user_id=?&quot;</span><span class="p">)</span>
<span class="n">user_lookup_stmt</span><span class="o">.</span><span class="n">consistency_level</span> <span class="o">=</span> <span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">QUORUM</span>

<span class="c1"># these will both use QUORUM</span>
<span class="n">user1</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">user_lookup_stmt</span><span class="p">,</span> <span class="p">[</span><span class="n">user_id1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">user2</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">user_lookup_stmt</span><span class="p">,</span> <span class="p">[</span><span class="n">user_id2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The second option is to create a <a class="reference internal" href="../api/cassandra/query/#cassandra.query.BoundStatement" title="cassandra.query.BoundStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoundStatement</span></code></a> from the
<a class="reference internal" href="../api/cassandra/query/#cassandra.query.PreparedStatement" title="cassandra.query.PreparedStatement"><code class="xref py py-class docutils literal notranslate"><span class="pre">PreparedStatement</span></code></a> and binding parameters and set a consistency
level on that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># override the QUORUM default</span>
<span class="n">user3_lookup</span> <span class="o">=</span> <span class="n">user_lookup_stmt</span><span class="o">.</span><span class="n">bind</span><span class="p">([</span><span class="n">user_id3</span><span class="p">])</span>
<span class="n">user3_lookup</span><span class="o">.</span><span class="n">consistency_level</span> <span class="o">=</span> <span class="n">ConsistencyLevel</span><span class="o">.</span><span class="n">ALL</span>
<span class="n">user3</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">user3_lookup</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="speculative-execution">
<h3>Speculative Execution<a class="headerlink" href="#speculative-execution" title="Permalink to this headline">¶</a></h3>
<p>Speculative execution is a way to minimize latency by preemptively executing several
instances of the same query against different nodes. For more details about this
technique, see <a class="reference external" href="https://docs.datastax.com/en/devapp/doc/devapp/driversSpeculativeRetry.html">Speculative Execution with DataStax Drivers</a>.</p>
<p>To enable speculative execution:</p>
<ul class="simple">
<li>Configure a <a class="reference internal" href="../api/cassandra/policies/#cassandra.policies.SpeculativeExecutionPolicy" title="cassandra.policies.SpeculativeExecutionPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpeculativeExecutionPolicy</span></code></a> with the ExecutionProfile</li>
<li>Mark your query as idempotent, which mean it can be applied multiple
times without changing the result of the initial application.
See <a class="reference external" href="https://docs.datastax.com/en/devapp/doc/devapp/driversQueryIdempotence.html">Query Idempotence</a> for more details.</li>
</ul>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cassandra.cluster</span> <span class="kn">import</span> <span class="n">Cluster</span><span class="p">,</span> <span class="n">ExecutionProfile</span><span class="p">,</span> <span class="n">EXEC_PROFILE_DEFAULT</span>
<span class="kn">from</span> <span class="nn">cassandra.policies</span> <span class="kn">import</span> <span class="n">ConstantSpeculativeExecutionPolicy</span>
<span class="kn">from</span> <span class="nn">cassandra.query</span> <span class="kn">import</span> <span class="n">SimpleStatement</span>

<span class="c1"># Configure the speculative execution policy</span>
<span class="n">ep</span> <span class="o">=</span> <span class="n">ExecutionProfile</span><span class="p">(</span>
    <span class="n">speculative_execution_policy</span><span class="o">=</span><span class="n">ConstantSpeculativeExecutionPolicy</span><span class="p">(</span><span class="n">delay</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_attempts</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">Cluster</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">execution_profiles</span><span class="o">=</span><span class="p">{</span><span class="n">EXEC_PROFILE_DEFAULT</span><span class="p">:</span> <span class="n">ep</span><span class="p">})</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># Mark the query idempotent</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">SimpleStatement</span><span class="p">(</span>
    <span class="s2">&quot;UPDATE my_table SET list_col = [1] WHERE pk = 1&quot;</span><span class="p">,</span>
    <span class="n">is_idempotent</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Execute. A new query will be sent to the server every 0.5 second</span>
<span class="c1"># until we receive a response, for a max number attempts of 10.</span>
<span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

        </div>

        <div id="sidebar" class="large-3 large-pull-6 columns"><div class="side-nav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scylla_specific/">Scylla Specific Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../execution_profiles/">Execution Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/">Performance Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../query_paging/">Paging Large Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lwt/">Lightweight Transactions (Compare-and-set)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_defined_types/">User Defined Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object_mapper/">Object Mapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dates_and_times/">Working with Dates and Times</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/">Frequently Asked Questions</a></li>
</ul>

</div>
        </div>

        <div class="large-3 columns">
            
        </div>

    </div>
</section>

<!-- newsleter modal -->

<div id="newsletter_signup" class="reveal-modal tiny radius dark_modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
    <a class="close-reveal-modal" aria-label="Close">×</a>
    <h2 id="modalTitle">Sign up for the Scylla newsletter</h2>
    <div id="mc_embed_signup">
        <form action="//cloudius-systems.us10.list-manage.com/subscribe/post?u=df8bb543c68230d5f7b4dcf78&amp;id=9a4589f144" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
            <div id="mc_embed_signup_scroll">

                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-EMAIL">Email</label></div>
                        <div class="small-9 columns"><input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-FNAME">First Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="FNAME" class="" id="mce-FNAME"></div>
                    </div>
                </div>
                <div class="mc-field-group">
                    <div class="row collapse">
                        <div class="small-3 columns"><label for="mce-LNAME">Last Name </label></div>
                        <div class="small-9 columns"><input type="text" value="" name="LNAME" class="" id="mce-LNAME"></div>
                    </div>
                </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;"><input type="text" name="b_df8bb543c68230d5f7b4dcf78_9a4589f144" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" class="button" value="Sign up" name="subscribe" id="mc-embedded-subscribe"></div>
            </div>
        </form>
    </div>
</div>

<!-- end newsleter modal -->



<!-- footer.html -->
<footer id="footer">
    <div class="footer-top">
        <a class="logo" href="https://www.scylladb.com"><img src="../_static/img/logo-scylla-horizontal-RGB.svg" alt=""></a>
        <div class="footer-links">
            <a class="link" href="https://docs.scylladb.com">Docs</a>
            <a class="link" href="https://www.scylladb.com/company/contact-us/">Contact Us</a>
            <a class="link" href="https://www.scylladb.com/company/">About Us</a>
            <a class="link button" href="https://github.com/scylladb/python-driver/issues/new?title=Issue in page Getting Started&&body=I%20would%20like%20to%20report%20an%20issue%20in%20page%20http://docs.scylladb.com/getting_started%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix" target="_blank">
                Report an issue on this page</a>
        </div>
        <div class="footer-actions">
            <a class="link-icon" href="https://github.com/ScyllaDB" target="_blank">
                <span class="icon-github2"></span></a>
            <a class="link-icon" href="https://twitter.com/ScyllaDB" target="_blank">
                <span class="icon-twitter"></span></a>
            <a class="link-icon" href="https://www.linkedin.com/company/scylladb"  target="_blank">
                <span class="icon-linkedin2"></span></a>
            <a class="link-icon" href="https://www.facebook.com/scylladb/" target="_blank">
                <span class="icon-facebook"></span></a>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-info">
            <div class="footer-copyright">
                &#169; 2013-2017 DataStax
            </div>
        </div>
        <div class="footer-links">
        </div>
    </div>
</footer>
<!-- end footer.html -->

<!-- bodyscripts.html -->
<!-- at the end of the BODY --> 
<script src="../_static/js/vendor/jquery.js"></script>
<script src="../_static/expertrec.js"></script>
<script src="../_static/js/foundation/foundation.js"></script>
<script src="../_static/js/foundation/foundation.topbar.js"></script>
<script src="../_static/app.js"></script>
<script>
    $(document).foundation();
</script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- end bodyscripts.html -->
</body>
</html>